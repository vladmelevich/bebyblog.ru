{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Wlad\\\\OneDrive\\\\Desktop\\\\kwork_site\\\\src\\\\components\\\\ChatPage\\\\ChatPageNew.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faArrowLeft, faPaperPlane, faEdit, faTrash, faCheck, faTimes, faUser, faMessage, faReply, faImage, faFile, faPaperclip, faFilePdf, faFileWord, faFileText, faFileArchive } from '@fortawesome/free-solid-svg-icons';\nimport { apiClient } from '../../utils/api';\nimport { wsClient } from '../../utils/websocket';\nimport './ChatPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatPage = () => {\n  _s();\n  const {\n    chatId\n  } = useParams();\n  const navigate = useNavigate();\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [editingMessageId, setEditingMessageId] = useState(null);\n  const [editText, setEditText] = useState('');\n  const [currentUser, setCurrentUser] = useState(null);\n  const [chatUser, setChatUser] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isTyping, setIsTyping] = useState(false);\n  const [typingUsers, setTypingUsers] = useState(new Set());\n  const [contextMenu, setContextMenu] = useState(null);\n  const [modalMessage, setModalMessage] = useState(null);\n  const [swipeStartX, setSwipeStartX] = useState(null);\n  const [swipeStartY, setSwipeStartY] = useState(null);\n  const [replyToMessage, setReplyToMessage] = useState(null);\n  const [selectedFiles, setSelectedFiles] = useState([]);\n  const [showMediaOptions, setShowMediaOptions] = useState(false);\n  const [sendingMessage, setSendingMessage] = useState(false);\n\n  // Загрузка данных чата\n  useEffect(() => {\n    loadChatData();\n  }, [chatId]);\n\n  // WebSocket соединение\n  useEffect(() => {\n    if (currentUser && chatId) {\n      wsClient.connect(currentUser.id);\n      wsClient.joinChat(parseInt(chatId));\n\n      // Обработчики WebSocket сообщений\n      wsClient.onMessage('new_message', handleNewMessage);\n      wsClient.onMessage('message_updated', handleMessageUpdated);\n      wsClient.onMessage('message_deleted', handleMessageDeleted);\n      wsClient.onMessage('typing', handleTyping);\n      return () => {\n        wsClient.leaveChat(parseInt(chatId));\n        wsClient.offMessage('new_message', handleNewMessage);\n        wsClient.offMessage('message_updated', handleMessageUpdated);\n        wsClient.offMessage('message_deleted', handleMessageDeleted);\n        wsClient.offMessage('typing', handleTyping);\n      };\n    }\n  }, [currentUser, chatId]);\n\n  // Автоскролл к последнему сообщению\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const loadChatData = async () => {\n    try {\n      setIsLoading(true);\n\n      // Получаем текущего пользователя\n      const user = await apiClient.getCurrentUser();\n      setCurrentUser(user);\n\n      // Получаем сообщения чата\n      const messagesData = await apiClient.getMessages(chatId);\n      setMessages(messagesData);\n\n      // Получаем информацию о собеседнике\n      const chats = await apiClient.getChats();\n      const currentChat = chats.find(chat => chat.id === parseInt(chatId));\n      if (currentChat) {\n        const otherUserId = currentChat.user1_id === user.id ? currentChat.user2_id : currentChat.user1_id;\n        const users = await apiClient.getUsers();\n        const otherUser = users.find(u => u.id === otherUserId);\n        setChatUser(otherUser);\n      }\n    } catch (error) {\n      console.error('Ошибка загрузки чата:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleNewMessage = data => {\n    setMessages(prev => [...prev, data.message]);\n  };\n  const handleMessageUpdated = data => {\n    setMessages(prev => prev.map(msg => msg.id === data.message.id ? data.message : msg));\n  };\n  const handleMessageDeleted = data => {\n    setMessages(prev => prev.filter(msg => msg.id !== data.message_id));\n  };\n  const handleTyping = data => {\n    if (data.user_id !== currentUser.id) {\n      setTypingUsers(prev => {\n        const newSet = new Set(prev);\n        if (data.is_typing) {\n          newSet.add(data.user_id);\n        } else {\n          newSet.delete(data.user_id);\n        }\n        return newSet;\n      });\n    }\n  };\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const handleSendMessage = async () => {\n    if (!newMessage.trim() && selectedFiles.length === 0 || sendingMessage) return;\n    try {\n      setSendingMessage(true);\n\n      // Отправляем текстовое сообщение\n      if (newMessage.trim()) {\n        const messageData = await apiClient.sendMessage(chatId, newMessage.trim());\n\n        // Загружаем файлы, если есть\n        if (selectedFiles.length > 0) {\n          for (const file of selectedFiles) {\n            await apiClient.uploadFile(messageData.id, file);\n          }\n        }\n      }\n      setNewMessage('');\n      setSelectedFiles([]);\n      setShowMediaOptions(false);\n    } catch (error) {\n      console.error('Ошибка отправки сообщения:', error);\n    } finally {\n      setSendingMessage(false);\n    }\n  };\n  const handleEditMessage = async () => {\n    if (!editText.trim()) return;\n    try {\n      await apiClient.updateMessage(editingMessageId, editText.trim());\n      setEditingMessageId(null);\n      setEditText('');\n    } catch (error) {\n      console.error('Ошибка редактирования сообщения:', error);\n    }\n  };\n  const handleDeleteMessage = async messageId => {\n    try {\n      await apiClient.deleteMessage(messageId);\n      setContextMenu(null);\n    } catch (error) {\n      console.error('Ошибка удаления сообщения:', error);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n  const handleInputChange = e => {\n    setNewMessage(e.target.value);\n\n    // Индикатор набора текста\n    if (e.target.value.trim()) {\n      wsClient.startTyping();\n    } else {\n      wsClient.stopTyping();\n    }\n  };\n  const handleFileSelect = e => {\n    const files = Array.from(e.target.files);\n    setSelectedFiles(prev => [...prev, ...files]);\n    setShowMediaOptions(false);\n  };\n  const removeFile = index => {\n    setSelectedFiles(prev => prev.filter((_, i) => i !== index));\n  };\n  const handleMediaOptionClick = type => {\n    if (type === 'photo') {\n      fileInputRef.current.accept = 'image/*';\n    } else if (type === 'document') {\n      fileInputRef.current.accept = '.pdf,.doc,.docx,.txt,.zip,.rar';\n    }\n    fileInputRef.current.click();\n  };\n  const getFileIcon = file => {\n    const extension = file.name.split('.').pop().toLowerCase();\n    switch (extension) {\n      case 'pdf':\n        return faFilePdf;\n      case 'doc':\n      case 'docx':\n        return faFileWord;\n      case 'txt':\n        return faFileText;\n      case 'zip':\n      case 'rar':\n        return faFileArchive;\n      default:\n        return faFile;\n    }\n  };\n  const formatFileSize = bytes => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n  const handleContextMenu = (e, message) => {\n    e.preventDefault();\n    if (message.sender_id === currentUser.id) {\n      setContextMenu({\n        x: e.clientX,\n        y: e.clientY,\n        message: message\n      });\n    }\n  };\n  const closeContextMenu = () => {\n    setContextMenu(null);\n  };\n  const formatTime = dateString => {\n    const date = new Date(dateString);\n    return date.toLocaleTimeString('ru-RU', {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-page\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-page\",\n    onClick: closeContextMenu,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"back-button\",\n        onClick: () => navigate('/friends'),\n        children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faArrowLeft\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-user-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-avatar\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: (chatUser === null || chatUser === void 0 ? void 0 : chatUser.avatar) || '/default-avatar.png',\n            alt: (chatUser === null || chatUser === void 0 ? void 0 : chatUser.name) || 'Пользователь'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-details\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"user-name\",\n            children: (chatUser === null || chatUser === void 0 ? void 0 : chatUser.name) || 'Пользователь'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"user-city\",\n            children: [\"\\uD83D\\uDCCD \", (chatUser === null || chatUser === void 0 ? void 0 : chatUser.city) || 'Город не указан']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-list\",\n        children: [messages.map(message => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${message.sender_id === currentUser.id ? 'my-message' : 'incoming-message'}`,\n          onContextMenu: e => handleContextMenu(e, message),\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: [message.text && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"message-text\",\n              children: message.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 19\n            }, this), message.files && message.files.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-files\",\n              children: message.files.map(file => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"message-file\",\n                children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                  icon: getFileIcon(file)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"file-name\",\n                  children: file.filename\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"file-size\",\n                  children: [\"(\", formatFileSize(file.file_size), \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 25\n                }, this)]\n              }, file.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 330,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-meta\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"message-time\",\n                children: formatTime(message.created_at)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 19\n              }, this), message.edited_at && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"edited-indicator\",\n                children: \"(\\u0440\\u0435\\u0434.)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 21\n              }, this), message.sender_id === currentUser.id && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"message-status\",\n                children: \"\\u2713\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 15\n          }, this)\n        }, message.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 13\n        }, this)), typingUsers.size > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"typing-indicator\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u041F\\u0435\\u0447\\u0430\\u0442\\u0430\\u0435\\u0442...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 7\n    }, this), selectedFiles.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"selected-files\",\n      children: selectedFiles.map((file, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"selected-file\",\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: getFileIcon(file)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"file-name\",\n          children: file.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"file-size\",\n          children: [\"(\", formatFileSize(file.size), \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"remove-file-btn\",\n          onClick: () => removeFile(index),\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faTimes\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 15\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 9\n    }, this), showMediaOptions && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"media-options\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"media-option\",\n        onClick: () => handleMediaOptionClick('photo'),\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this), \"\\u0424\\u043E\\u0442\\u043E\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"media-option\",\n        onClick: () => handleMediaOptionClick('document'),\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faFile\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 13\n        }, this), \"\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"message-input-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message-input-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"media-button\",\n          onClick: () => setShowMediaOptions(!showMediaOptions),\n          title: \"\\u041F\\u0440\\u0438\\u043A\\u0440\\u0435\\u043F\\u0438\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\",\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faPaperclip\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"message-input\",\n          placeholder: \"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",\n          value: newMessage,\n          onChange: handleInputChange,\n          onKeyPress: handleKeyPress,\n          rows: 1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"send-button\",\n          onClick: handleSendMessage,\n          disabled: !newMessage.trim() && selectedFiles.length === 0 || sendingMessage,\n          title: \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\",\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faPaperPlane\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: fileInputRef,\n        type: \"file\",\n        multiple: true,\n        accept: \"image/*,.pdf,.doc,.docx,.txt,.zip,.rar\",\n        onChange: handleFileSelect,\n        className: \"file-input\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 7\n    }, this), contextMenu && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"context-menu\",\n      style: {\n        position: 'fixed',\n        left: contextMenu.x,\n        top: contextMenu.y,\n        zIndex: 1000\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"context-menu-item\",\n        onClick: () => {\n          setEditingMessageId(contextMenu.message.id);\n          setEditText(contextMenu.message.text || '');\n          setContextMenu(null);\n        },\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faEdit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 13\n        }, this), \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"context-menu-item delete\",\n        onClick: () => handleDeleteMessage(contextMenu.message.id),\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faTrash\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 13\n        }, this), \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 9\n    }, this), editingMessageId && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onClick: () => setEditingMessageId(null),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"edit-modal\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: editText,\n          onChange: e => setEditText(e.target.value),\n          className: \"edit-textarea\",\n          rows: 3\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"cancel-button\",\n            onClick: () => setEditingMessageId(null),\n            children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faTimes\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 17\n            }, this), \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"save-button\",\n            onClick: handleEditMessage,\n            disabled: !editText.trim(),\n            children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faCheck\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 499,\n              columnNumber: 17\n            }, this), \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 292,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatPage, \"fYT2Awk1KpUpmPg+2wtcyO0+aRg=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ChatPage;\nexport default ChatPage;\nvar _c;\n$RefreshReg$(_c, \"ChatPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useNavigate","FontAwesomeIcon","faArrowLeft","faPaperPlane","faEdit","faTrash","faCheck","faTimes","faUser","faMessage","faReply","faImage","faFile","faPaperclip","faFilePdf","faFileWord","faFileText","faFileArchive","apiClient","wsClient","jsxDEV","_jsxDEV","ChatPage","_s","chatId","navigate","messagesEndRef","fileInputRef","messages","setMessages","newMessage","setNewMessage","editingMessageId","setEditingMessageId","editText","setEditText","currentUser","setCurrentUser","chatUser","setChatUser","isLoading","setIsLoading","isTyping","setIsTyping","typingUsers","setTypingUsers","Set","contextMenu","setContextMenu","modalMessage","setModalMessage","swipeStartX","setSwipeStartX","swipeStartY","setSwipeStartY","replyToMessage","setReplyToMessage","selectedFiles","setSelectedFiles","showMediaOptions","setShowMediaOptions","sendingMessage","setSendingMessage","loadChatData","connect","id","joinChat","parseInt","onMessage","handleNewMessage","handleMessageUpdated","handleMessageDeleted","handleTyping","leaveChat","offMessage","scrollToBottom","user","getCurrentUser","messagesData","getMessages","chats","getChats","currentChat","find","chat","otherUserId","user1_id","user2_id","users","getUsers","otherUser","u","error","console","data","prev","message","map","msg","filter","message_id","user_id","newSet","is_typing","add","delete","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSendMessage","trim","length","messageData","sendMessage","file","uploadFile","handleEditMessage","updateMessage","handleDeleteMessage","messageId","deleteMessage","handleKeyPress","e","key","shiftKey","preventDefault","handleInputChange","target","value","startTyping","stopTyping","handleFileSelect","files","Array","from","removeFile","index","_","i","handleMediaOptionClick","type","accept","click","getFileIcon","extension","name","split","pop","toLowerCase","formatFileSize","bytes","k","sizes","Math","floor","log","parseFloat","pow","toFixed","handleContextMenu","sender_id","x","clientX","y","clientY","closeContextMenu","formatTime","dateString","date","Date","toLocaleTimeString","hour","minute","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","icon","src","avatar","alt","city","onContextMenu","text","filename","file_size","created_at","edited_at","size","ref","title","placeholder","onChange","onKeyPress","rows","disabled","multiple","style","position","left","top","zIndex","stopPropagation","_c","$RefreshReg$"],"sources":["C:/Users/Wlad/OneDrive/Desktop/kwork_site/src/components/ChatPage/ChatPageNew.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { \r\n  faArrowLeft, \r\n  faPaperPlane, \r\n  faEdit, \r\n  faTrash, \r\n  faCheck, \r\n  faTimes,\r\n  faUser,\r\n  faMessage,\r\n  faReply,\r\n  faImage,\r\n  faFile,\r\n  faPaperclip,\r\n  faFilePdf,\r\n  faFileWord,\r\n  faFileText,\r\n  faFileArchive\r\n} from '@fortawesome/free-solid-svg-icons';\r\nimport { apiClient } from '../../utils/api';\r\nimport { wsClient } from '../../utils/websocket';\r\nimport './ChatPage.css';\r\n\r\nconst ChatPage = () => {\r\n  const { chatId } = useParams();\r\n  const navigate = useNavigate();\r\n  const messagesEndRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [editingMessageId, setEditingMessageId] = useState(null);\r\n  const [editText, setEditText] = useState('');\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n  const [chatUser, setChatUser] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [typingUsers, setTypingUsers] = useState(new Set());\r\n  const [contextMenu, setContextMenu] = useState(null);\r\n  const [modalMessage, setModalMessage] = useState(null);\r\n  const [swipeStartX, setSwipeStartX] = useState(null);\r\n  const [swipeStartY, setSwipeStartY] = useState(null);\r\n  const [replyToMessage, setReplyToMessage] = useState(null);\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n  const [showMediaOptions, setShowMediaOptions] = useState(false);\r\n  const [sendingMessage, setSendingMessage] = useState(false);\r\n\r\n  // Загрузка данных чата\r\n  useEffect(() => {\r\n    loadChatData();\r\n  }, [chatId]);\r\n\r\n  // WebSocket соединение\r\n  useEffect(() => {\r\n    if (currentUser && chatId) {\r\n      wsClient.connect(currentUser.id);\r\n      wsClient.joinChat(parseInt(chatId));\r\n      \r\n      // Обработчики WebSocket сообщений\r\n      wsClient.onMessage('new_message', handleNewMessage);\r\n      wsClient.onMessage('message_updated', handleMessageUpdated);\r\n      wsClient.onMessage('message_deleted', handleMessageDeleted);\r\n      wsClient.onMessage('typing', handleTyping);\r\n      \r\n      return () => {\r\n        wsClient.leaveChat(parseInt(chatId));\r\n        wsClient.offMessage('new_message', handleNewMessage);\r\n        wsClient.offMessage('message_updated', handleMessageUpdated);\r\n        wsClient.offMessage('message_deleted', handleMessageDeleted);\r\n        wsClient.offMessage('typing', handleTyping);\r\n      };\r\n    }\r\n  }, [currentUser, chatId]);\r\n\r\n  // Автоскролл к последнему сообщению\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const loadChatData = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      \r\n      // Получаем текущего пользователя\r\n      const user = await apiClient.getCurrentUser();\r\n      setCurrentUser(user);\r\n      \r\n      // Получаем сообщения чата\r\n      const messagesData = await apiClient.getMessages(chatId);\r\n      setMessages(messagesData);\r\n      \r\n      // Получаем информацию о собеседнике\r\n      const chats = await apiClient.getChats();\r\n      const currentChat = chats.find(chat => chat.id === parseInt(chatId));\r\n      if (currentChat) {\r\n        const otherUserId = currentChat.user1_id === user.id ? currentChat.user2_id : currentChat.user1_id;\r\n        const users = await apiClient.getUsers();\r\n        const otherUser = users.find(u => u.id === otherUserId);\r\n        setChatUser(otherUser);\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Ошибка загрузки чата:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleNewMessage = (data) => {\r\n    setMessages(prev => [...prev, data.message]);\r\n  };\r\n\r\n  const handleMessageUpdated = (data) => {\r\n    setMessages(prev => \r\n      prev.map(msg => \r\n        msg.id === data.message.id ? data.message : msg\r\n      )\r\n    );\r\n  };\r\n\r\n  const handleMessageDeleted = (data) => {\r\n    setMessages(prev => \r\n      prev.filter(msg => msg.id !== data.message_id)\r\n    );\r\n  };\r\n\r\n  const handleTyping = (data) => {\r\n    if (data.user_id !== currentUser.id) {\r\n      setTypingUsers(prev => {\r\n        const newSet = new Set(prev);\r\n        if (data.is_typing) {\r\n          newSet.add(data.user_id);\r\n        } else {\r\n          newSet.delete(data.user_id);\r\n        }\r\n        return newSet;\r\n      });\r\n    }\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const handleSendMessage = async () => {\r\n    if ((!newMessage.trim() && selectedFiles.length === 0) || sendingMessage) return;\r\n\r\n    try {\r\n      setSendingMessage(true);\r\n      \r\n      // Отправляем текстовое сообщение\r\n      if (newMessage.trim()) {\r\n        const messageData = await apiClient.sendMessage(chatId, newMessage.trim());\r\n        \r\n        // Загружаем файлы, если есть\r\n        if (selectedFiles.length > 0) {\r\n          for (const file of selectedFiles) {\r\n            await apiClient.uploadFile(messageData.id, file);\r\n          }\r\n        }\r\n      }\r\n      \r\n      setNewMessage('');\r\n      setSelectedFiles([]);\r\n      setShowMediaOptions(false);\r\n      \r\n    } catch (error) {\r\n      console.error('Ошибка отправки сообщения:', error);\r\n    } finally {\r\n      setSendingMessage(false);\r\n    }\r\n  };\r\n\r\n  const handleEditMessage = async () => {\r\n    if (!editText.trim()) return;\r\n\r\n    try {\r\n      await apiClient.updateMessage(editingMessageId, editText.trim());\r\n      setEditingMessageId(null);\r\n      setEditText('');\r\n    } catch (error) {\r\n      console.error('Ошибка редактирования сообщения:', error);\r\n    }\r\n  };\r\n\r\n  const handleDeleteMessage = async (messageId) => {\r\n    try {\r\n      await apiClient.deleteMessage(messageId);\r\n      setContextMenu(null);\r\n    } catch (error) {\r\n      console.error('Ошибка удаления сообщения:', error);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    setNewMessage(e.target.value);\r\n    \r\n    // Индикатор набора текста\r\n    if (e.target.value.trim()) {\r\n      wsClient.startTyping();\r\n    } else {\r\n      wsClient.stopTyping();\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    setSelectedFiles(prev => [...prev, ...files]);\r\n    setShowMediaOptions(false);\r\n  };\r\n\r\n  const removeFile = (index) => {\r\n    setSelectedFiles(prev => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleMediaOptionClick = (type) => {\r\n    if (type === 'photo') {\r\n      fileInputRef.current.accept = 'image/*';\r\n    } else if (type === 'document') {\r\n      fileInputRef.current.accept = '.pdf,.doc,.docx,.txt,.zip,.rar';\r\n    }\r\n    fileInputRef.current.click();\r\n  };\r\n\r\n  const getFileIcon = (file) => {\r\n    const extension = file.name.split('.').pop().toLowerCase();\r\n    switch (extension) {\r\n      case 'pdf':\r\n        return faFilePdf;\r\n      case 'doc':\r\n      case 'docx':\r\n        return faFileWord;\r\n      case 'txt':\r\n        return faFileText;\r\n      case 'zip':\r\n      case 'rar':\r\n        return faFileArchive;\r\n      default:\r\n        return faFile;\r\n    }\r\n  };\r\n\r\n  const formatFileSize = (bytes) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  };\r\n\r\n  const handleContextMenu = (e, message) => {\r\n    e.preventDefault();\r\n    if (message.sender_id === currentUser.id) {\r\n      setContextMenu({\r\n        x: e.clientX,\r\n        y: e.clientY,\r\n        message: message\r\n      });\r\n    }\r\n  };\r\n\r\n  const closeContextMenu = () => {\r\n    setContextMenu(null);\r\n  };\r\n\r\n  const formatTime = (dateString) => {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleTimeString('ru-RU', { \r\n      hour: '2-digit', \r\n      minute: '2-digit' \r\n    });\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"chat-page\">\r\n        <div className=\"loading\">Загрузка...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"chat-page\" onClick={closeContextMenu}>\r\n      {/* Заголовок чата */}\r\n      <div className=\"chat-header\">\r\n        <button className=\"back-button\" onClick={() => navigate('/friends')}>\r\n          <FontAwesomeIcon icon={faArrowLeft} />\r\n        </button>\r\n        <div className=\"chat-user-info\">\r\n          <div className=\"user-avatar\">\r\n            <img \r\n              src={chatUser?.avatar || '/default-avatar.png'} \r\n              alt={chatUser?.name || 'Пользователь'} \r\n            />\r\n          </div>\r\n          <div className=\"user-details\">\r\n            <h3 className=\"user-name\">{chatUser?.name || 'Пользователь'}</h3>\r\n            <span className=\"user-city\">📍 {chatUser?.city || 'Город не указан'}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Контейнер сообщений */}\r\n      <div className=\"messages-container\">\r\n        <div className=\"messages-list\">\r\n          {messages.map((message) => (\r\n            <div\r\n              key={message.id}\r\n              className={`message ${message.sender_id === currentUser.id ? 'my-message' : 'incoming-message'}`}\r\n              onContextMenu={(e) => handleContextMenu(e, message)}\r\n            >\r\n              <div className=\"message-content\">\r\n                {message.text && (\r\n                  <p className=\"message-text\">{message.text}</p>\r\n                )}\r\n                \r\n                {/* Файлы сообщения */}\r\n                {message.files && message.files.length > 0 && (\r\n                  <div className=\"message-files\">\r\n                    {message.files.map((file) => (\r\n                      <div key={file.id} className=\"message-file\">\r\n                        <FontAwesomeIcon icon={getFileIcon(file)} />\r\n                        <span className=\"file-name\">{file.filename}</span>\r\n                        <span className=\"file-size\">({formatFileSize(file.file_size)})</span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n                \r\n                <div className=\"message-meta\">\r\n                  <span className=\"message-time\">{formatTime(message.created_at)}</span>\r\n                  {message.edited_at && (\r\n                    <span className=\"edited-indicator\">(ред.)</span>\r\n                  )}\r\n                  {message.sender_id === currentUser.id && (\r\n                    <span className=\"message-status\">✓</span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n          \r\n          {/* Индикатор набора текста */}\r\n          {typingUsers.size > 0 && (\r\n            <div className=\"typing-indicator\">\r\n              <span>Печатает...</span>\r\n            </div>\r\n          )}\r\n          \r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Выбранные файлы */}\r\n      {selectedFiles.length > 0 && (\r\n        <div className=\"selected-files\">\r\n          {selectedFiles.map((file, index) => (\r\n            <div key={index} className=\"selected-file\">\r\n              <FontAwesomeIcon icon={getFileIcon(file)} />\r\n              <span className=\"file-name\">{file.name}</span>\r\n              <span className=\"file-size\">({formatFileSize(file.size)})</span>\r\n              <button \r\n                className=\"remove-file-btn\"\r\n                onClick={() => removeFile(index)}\r\n              >\r\n                <FontAwesomeIcon icon={faTimes} />\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Опции медиа */}\r\n      {showMediaOptions && (\r\n        <div className=\"media-options\">\r\n          <button \r\n            className=\"media-option\"\r\n            onClick={() => handleMediaOptionClick('photo')}\r\n          >\r\n            <FontAwesomeIcon icon={faImage} />\r\n            Фото\r\n          </button>\r\n          <button \r\n            className=\"media-option\"\r\n            onClick={() => handleMediaOptionClick('document')}\r\n          >\r\n            <FontAwesomeIcon icon={faFile} />\r\n            Документ\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Форма ввода */}\r\n      <div className=\"message-input-container\">\r\n        <div className=\"message-input-wrapper\">\r\n          <button \r\n            className=\"media-button\"\r\n            onClick={() => setShowMediaOptions(!showMediaOptions)}\r\n            title=\"Прикрепить файл\"\r\n          >\r\n            <FontAwesomeIcon icon={faPaperclip} />\r\n          </button>\r\n          \r\n          <textarea\r\n            className=\"message-input\"\r\n            placeholder=\"Сообщение\"\r\n            value={newMessage}\r\n            onChange={handleInputChange}\r\n            onKeyPress={handleKeyPress}\r\n            rows={1}\r\n          />\r\n          \r\n          <button \r\n            className=\"send-button\"\r\n            onClick={handleSendMessage}\r\n            disabled={(!newMessage.trim() && selectedFiles.length === 0) || sendingMessage}\r\n            title=\"Отправить\"\r\n          >\r\n            <FontAwesomeIcon icon={faPaperPlane} />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Скрытый input для файлов */}\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          multiple\r\n          accept=\"image/*,.pdf,.doc,.docx,.txt,.zip,.rar\"\r\n          onChange={handleFileSelect}\r\n          className=\"file-input\"\r\n        />\r\n      </div>\r\n\r\n      {/* Контекстное меню */}\r\n      {contextMenu && (\r\n        <div\r\n          className=\"context-menu\"\r\n          style={{\r\n            position: 'fixed',\r\n            left: contextMenu.x,\r\n            top: contextMenu.y,\r\n            zIndex: 1000\r\n          }}\r\n        >\r\n          <button\r\n            className=\"context-menu-item\"\r\n            onClick={() => {\r\n              setEditingMessageId(contextMenu.message.id);\r\n              setEditText(contextMenu.message.text || '');\r\n              setContextMenu(null);\r\n            }}\r\n          >\r\n            <FontAwesomeIcon icon={faEdit} />\r\n            Редактировать\r\n          </button>\r\n          <button\r\n            className=\"context-menu-item delete\"\r\n            onClick={() => handleDeleteMessage(contextMenu.message.id)}\r\n          >\r\n            <FontAwesomeIcon icon={faTrash} />\r\n            Удалить\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Модальное окно редактирования */}\r\n      {editingMessageId && (\r\n        <div className=\"modal-overlay\" onClick={() => setEditingMessageId(null)}>\r\n          <div className=\"edit-modal\" onClick={(e) => e.stopPropagation()}>\r\n            <h3>Редактировать сообщение</h3>\r\n            <textarea\r\n              value={editText}\r\n              onChange={(e) => setEditText(e.target.value)}\r\n              className=\"edit-textarea\"\r\n              rows={3}\r\n            />\r\n            <div className=\"modal-buttons\">\r\n              <button\r\n                className=\"cancel-button\"\r\n                onClick={() => setEditingMessageId(null)}\r\n              >\r\n                <FontAwesomeIcon icon={faTimes} />\r\n                Отмена\r\n              </button>\r\n              <button\r\n                className=\"save-button\"\r\n                onClick={handleEditMessage}\r\n                disabled={!editText.trim()}\r\n              >\r\n                <FontAwesomeIcon icon={faCheck} />\r\n                Сохранить\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}